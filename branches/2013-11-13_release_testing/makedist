#!/usr/bin/perl

use XML::Simple;
use Data::Dumper;

$xml = new XML::Simple;

$data = $xml->XMLin(".distfiles");

#print Dumper($data);
my @files;
foreach $entry (values $data->{"target"}->{"entry"}) {
    if ($entry->{"path"} eq ".") {
        next;
    }
    if ($entry->{"wc-status"}->{"item"} eq "deleted") {
        next;
    }
    if ($entry->{"wc-status"}->{"item"} ne "unversioned") {
        if (! -d $entry->{"path"}) {
            push(@files, $entry->{"path"});
        }
    }
}
open(DISTFILE, ">distfiles.mk");
print DISTFILE "# This File is automatically generated by make dist-update\n";
print DISTFILE "# Any Edits on this file will be lost next time dist-update is run\n\n";
print DISTFILE "DISTFILES = ";
foreach $file (values @files) {
    print DISTFILE "    $file \\\n";
}
#always add vers.cpp
print DISTFILE "    cpp/src/vers.cpp\n";
    